# 萤窗 (Gleam)

[English](README.md)

思源笔记 AI 对话助手插件，目前支持 OpenRouter AI 供应商。

## 功能特性

- 🤖 **OpenRouter 支持**：目前支持 OpenRouter AI 供应商（可访问多个 AI 模型）
- 💬 **聊天界面**：集成在思源笔记中的简洁直观聊天界面
- 📝 **上下文注入**：自动将当前文档内容作为上下文注入
- 🎨 **Markdown 渲染**：完整的 Markdown 支持，包括代码高亮
- 📎 **多模态支持**：支持图片和音频输入
- 📚 **聊天历史**：保存和管理对话历史记录
- ⚙️ **模型选择**：便捷的模型选择，支持搜索功能
- 🔧 **参数配置**：自定义温度、最大令牌数等参数
- 🔄 **重新生成**：一键重新生成 AI 回复
- 📋 **复制导出**：复制消息或图片到剪贴板

## 安装

1. 打开思源笔记
2. 进入设置 → 集市
3. 搜索 "Gleam" 或 "萤窗"
4. 点击安装

## 快速开始

### 1. 配置 API 密钥

1. 打开思源笔记设置
2. 进入 **插件** → **萤窗**
3. 输入您的 OpenRouter API 密钥（以 `sk-` 开头）
4. 点击保存

### 2. 选择模型

1. 打开萤窗停靠面板（右侧边栏）
2. 点击模型选择按钮
3. 搜索并选择您偏好的模型
4. 开始对话！

### 3. 使用上下文注入

1. 在思源笔记中打开一个文档
2. 在聊天面板中启用"上下文注入"开关
3. 当前文档内容将自动作为上下文包含

## 配置说明

### 设置项

- **OpenRouter API 密钥**：您的 OpenRouter 服务 API 密钥
- **默认模型**：新建对话时默认使用的模型
- **最大历史数量**：未收藏历史记录的最大数量（1-1000）
- **启用调试日志**：启用调试日志以便排查问题

### 模型参数

点击参数按钮（⚙️）进行配置：
- **温度 (Temperature)**：控制随机性（0.0 - 2.0）
- **最大令牌数 (Max Tokens)**：回复中的最大令牌数
- **Top P**：核采样参数
- **频率惩罚 (Frequency Penalty)**：减少重复
- **存在惩罚 (Presence Penalty)**：鼓励新话题

## 使用技巧

- **插入文档**：点击文档图标将当前文档内容插入到输入框
- **图片输入**：点击图片图标为消息附加图片
- **音频输入**：支持音频输入（需要模型支持）
- **历史管理**：点击历史按钮查看和管理过去的对话
- **新对话**：使用新对话按钮开始全新的对话
- **重新生成**：点击任何 AI 消息上的重新生成按钮获取新回复

## 支持的模型

萤窗支持通过 OpenRouter 提供的所有模型，包括：
- OpenAI 模型（GPT-4、GPT-3.5 等）
- Anthropic 模型（Claude 3 等）
- Google 模型（Gemini 等）
- 以及更多...

## 系统要求

- 思源笔记版本 3.4.2 或更高
- 桌面环境（Windows、macOS、Linux、Docker）
- 有效的 OpenRouter API 密钥

## 开发

### 前置要求

- Node.js
- pnpm

### 设置

```bash
# 安装依赖
pnpm install

# 开发模式（热重载）
pnpm run dev

# 生产构建
pnpm run build
```

## 许可证

MIT

## 作者

hendyzone

## 链接

- [GitHub 仓库](https://github.com/hendyzone/Gleam.git)
- [思源笔记](https://b3log.org/siyuan/)
